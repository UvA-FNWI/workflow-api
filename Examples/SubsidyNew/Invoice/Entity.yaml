name: Invoice
index: 2
titlePlural: Invoices
instanceTitle: 'Invoice ({{ Invoice.Name }})'
headerFields:
  - property: Invoice.Request
    title: Request
    href: '/instances/{{ Invoice.Request.Id }}'
  - property: Invoice.Number
    title: Number

properties:
  - name: Number
    type: String
  - name: Request
    type: Request!
  - name: Invoice
    type: File!
  - name: Name
    text: Name beneficiary (such as university X)
    type: String!
  - name: Description
    text: Required information for payment description (such as reference number, invoice number and/or contact person)
    type: String
  - name: HasIBAN
    text: Does the beneficiary have an IBAN?
    type: YesNo!
    layout: RadioList
    values:
      Yes: {}
      No: {}
  - name: IBAN
    text: IBAN beneficiary
    type: String!
    condition:
      value:
        property: HasIBAN
        equal: =Yes
  - name: Address
    text: Address beneficiary, including country
    type: String!
    condition: NoIBAN
  - name: BankName
    text: Name bank
    type: String!
    condition: NoIBAN
  - name: BankAddress
    text: Address bank
    type: String!
    condition: NoIBAN
  - name: BIC
    text: SWIFT code/BIC
    type: String!
    condition: NoIBAN
  - name: Account
    text: Account number
    type: String!
    condition: NoIBAN
    
  - name: PaymentAmount
    type: Currency!
  - name: PaymentDate
    type: Date!

steps:
  - Start
  - Handling
  - Approval

actions:
  - roles: [Submitter, BoardMember]
    type: View
    form: Invoice
  - roles: [Admin]
    type: View
    form: Payment
  - type: Execute
    label: Reject invoice
    roles: [Admin]
    onAction:
      - sendMail:
          to: Submitter
          template: InvoiceRejected
